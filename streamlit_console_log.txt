
  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://192.168.20.19:8502

2025-08-08 17:51:30,834 - [INFO] - [src.tools.clients:48] - Google AI client configured successfully.
2025-08-08 17:51:30,834 - [INFO] - [src.tools.clients:65] - Requesting Flash Model: gemini-1.5-flash-latest
2025-08-08 17:51:30,836 - [INFO] - [src.planner.tool_planner:58] - Successfully loaded persona-tool map from '/home/mit/persona_rag_chatbot/config/persona_tool_map.yml'.
2025-08-08 17:51:30,836 - [INFO] - [src.router.tool_router:19] - ToolRouter initialized with 2 tools.
2025-08-08 17:51:30,836 - [INFO] - [src.tools.clients:58] - Requesting GenerativeModel: gemini-1.5-pro-latest
2025-08-08 17:51:30,836 - [INFO] - [src.tools.clients:65] - Requesting Flash Model: gemini-1.5-flash-latest
2025-08-08 17:51:30,836 - [INFO] - [__main__:51] - Unified agent initialized successfully and cached for the session.
2025-08-08 17:51:32,712 - [INFO] - [src.planner.query_rewriter:76] - Query deemed standalone. Bypassing LLM rewrite. Query: 'What is the dosage form of Apomorphine?'
2025-08-08 17:51:40,354 - [INFO] - [src.planner.persona_classifier:60] - Query classified for persona: 'clinical_analyst'
2025-08-08 17:51:48,390 - [INFO] - [src.agent:61] - [TIMER] Decomposition took 8036.24 ms
2025-08-08 17:51:48,390 - [INFO] - [src.agent:229] - Executing single-step plan for query: 'What is the dosage form of Apomorphine?'
2025-08-08 17:51:48,390 - [INFO] - [src.planner.query_classifier:56] - Classifying query: What is the dosage form of Apomorphine?
2025-08-08 17:51:57,008 - [INFO] - [src.planner.query_classifier:76] - Classification result: {
  "intent": "specific_fact_lookup",
  "keywords": [
    "Apomorphine",
    "dosage form"
  ],
  "question_is_graph_suitable": true,
  "themes": [
    "Dosage and Administration"
  ]
}
2025-08-08 17:51:57,008 - [INFO] - [src.planner.tool_planner:67] - Planning tools for intent 'specific_fact_lookup' and persona 'clinical_analyst'
2025-08-08 17:51:57,008 - [INFO] - [src.planner.tool_planner:110] - Coverage threshold of 0.85 met. Finalizing plan.
2025-08-08 17:51:57,008 - [INFO] - [src.planner.tool_planner:113] - Generated tool plan: ['{\n  "tool_name": "query_knowledge_graph",\n  "estimated_coverage": 0.81\n}', '{\n  "tool_name": "vector_search",\n  "estimated_coverage": 0.5\n}']
2025-08-08 17:51:57,008 - [INFO] - [src.agent:132] - Query is suitable for Knowledge Graph. Executing KG tool first.
2025-08-08 17:51:57,008 - [INFO] - [src.router.tool_router:22] - [ToolRouter] Executing tool: 'query_knowledge_graph'
2025-08-08 17:51:58,195 - [INFO] - [src.tools.clients:97] - Neo4j driver connected successfully.
2025-08-08 17:52:08,431 - [INFO] - [src.tools.retrievers:170] - Generated Cypher: MATCH (start_node:Entity)-[r:HASDOSAGEFORM]->(end_node:Entity) WHERE start_node.name_normalized = 'apomorphine' RETURN start_node, end_node, type(r) as rel_type, properties(r) as r_props
2025-08-08 17:52:08,644 - [INFO] - [src.tools.retrievers:179] - KG tool successfully retrieved and serialized 3 facts.
2025-08-08 17:52:08,644 - [INFO] - [src.tools.retrievers:32] - [TIMER] Tool: query_knowledge_graph took 11635.30 ms
2025-08-08 17:52:08,644 - [INFO] - [src.agent:137] - Knowledge Graph provided a definitive answer. Finalizing retrieval, skipping vector search.
2025-08-08 17:52:17,062 - [INFO] - [src.agent:61] - [TIMER] Synthesis LLM Call (Flash) took 8418.37 ms
2025-08-08 17:52:17,062 - [INFO] - [src.agent:61] - [TIMER] Single RAG Step for 'What is the dosage form of Apo...' took 28672.06 ms
2025-08-08 17:52:17,062 - [INFO] - [src.agent:61] - [TIMER] Full Agent Run took 44349.96 ms
2025-08-08 17:55:15,561 - [INFO] - [src.planner.query_rewriter:76] - Query deemed standalone. Bypassing LLM rewrite. Query: 'Which sponsors made submissions in both the March 2025 and July 2025 meetings?'
2025-08-08 17:55:16,891 - [INFO] - [src.planner.persona_classifier:60] - Query classified for persona: 'regulatory_specialist'
2025-08-08 17:55:17,935 - [INFO] - [src.agent:61] - [TIMER] Decomposition took 1043.52 ms
2025-08-08 17:55:17,935 - [INFO] - [src.agent:232] - Executing multi-step plan for query: 'Which sponsors made submissions in both the March 2025 and July 2025 meetings?'
2025-08-08 17:55:17,935 - [INFO] - [src.planner.query_classifier:56] - Classifying query: Which sponsors made submissions in the March 2025 meeting?
2025-08-08 17:55:17,936 - [INFO] - [src.planner.query_classifier:56] - Classifying query: Which sponsors made submissions in the July 2025 meeting?
2025-08-08 17:55:19,565 - [INFO] - [src.planner.query_classifier:76] - Classification result: {
  "intent": "specific_fact_lookup",
  "keywords": [
    "sponsors",
    "submissions",
    "March 2025 meeting"
  ],
  "question_is_graph_suitable": true,
  "themes": [
    "Regulatory History"
  ]
}
2025-08-08 17:55:19,566 - [INFO] - [src.planner.tool_planner:67] - Planning tools for intent 'specific_fact_lookup' and persona 'regulatory_specialist'
2025-08-08 17:55:19,566 - [INFO] - [src.planner.tool_planner:110] - Coverage threshold of 0.85 met. Finalizing plan.
2025-08-08 17:55:19,566 - [INFO] - [src.planner.tool_planner:113] - Generated tool plan: ['{\n  "tool_name": "query_knowledge_graph",\n  "estimated_coverage": 0.81\n}', '{\n  "tool_name": "vector_search",\n  "estimated_coverage": 0.5\n}']
2025-08-08 17:55:19,566 - [INFO] - [src.agent:132] - Query is suitable for Knowledge Graph. Executing KG tool first.
2025-08-08 17:55:19,566 - [INFO] - [src.router.tool_router:22] - [ToolRouter] Executing tool: 'query_knowledge_graph'
2025-08-08 17:55:19,767 - [INFO] - [src.planner.query_classifier:76] - Classification result: {
  "intent": "specific_fact_lookup",
  "keywords": [
    "sponsors",
    "submissions",
    "July 2025 meeting"
  ],
  "question_is_graph_suitable": true,
  "themes": [
    "Regulatory History"
  ]
}
2025-08-08 17:55:19,767 - [INFO] - [src.planner.tool_planner:67] - Planning tools for intent 'specific_fact_lookup' and persona 'regulatory_specialist'
2025-08-08 17:55:19,767 - [INFO] - [src.planner.tool_planner:110] - Coverage threshold of 0.85 met. Finalizing plan.
2025-08-08 17:55:19,768 - [INFO] - [src.planner.tool_planner:113] - Generated tool plan: ['{\n  "tool_name": "query_knowledge_graph",\n  "estimated_coverage": 0.81\n}', '{\n  "tool_name": "vector_search",\n  "estimated_coverage": 0.5\n}']
2025-08-08 17:55:19,768 - [INFO] - [src.agent:132] - Query is suitable for Knowledge Graph. Executing KG tool first.
2025-08-08 17:55:19,768 - [INFO] - [src.router.tool_router:22] - [ToolRouter] Executing tool: 'query_knowledge_graph'
2025-08-08 17:55:20,485 - [INFO] - [src.tools.retrievers:32] - [TIMER] Tool: query_knowledge_graph took 919.77 ms
2025-08-08 17:55:20,486 - [INFO] - [src.agent:142] - KG was unsuitable or did not provide a definitive answer. Executing vector search.
2025-08-08 17:55:20,486 - [INFO] - [src.router.tool_router:22] - [ToolRouter] Executing tool: 'vector_search'
2025-08-08 17:55:21,393 - [INFO] - [src.tools.retrievers:32] - [TIMER] Tool: query_knowledge_graph took 1625.01 ms
2025-08-08 17:55:21,393 - [INFO] - [src.agent:142] - KG was unsuitable or did not provide a definitive answer. Executing vector search.
2025-08-08 17:55:21,393 - [INFO] - [src.router.tool_router:22] - [ToolRouter] Executing tool: 'vector_search'
2025-08-08 17:55:21,589 - [INFO] - [src.tools.clients:79] - Pinecone index 'pbac-rag-index' connected successfully.
2025-08-08 17:55:21,589 - [INFO] - [src.tools.retrievers:116] - Applying metadata filter: {'semantic_purpose': {'$in': ['Regulatory History']}}
2025-08-08 17:55:22,373 - [INFO] - [src.tools.clients:79] - Pinecone index 'pbac-rag-index' connected successfully.
2025-08-08 17:55:22,375 - [INFO] - [src.tools.retrievers:116] - Applying metadata filter: {'semantic_purpose': {'$in': ['Regulatory History']}}
2025-08-08 17:55:23,174 - [INFO] - [src.tools.retrievers:32] - [TIMER] Tool: vector_search took 2688.56 ms
2025-08-08 17:55:23,927 - [INFO] - [src.agent:116] - Re-ranked 3 snippets down to 2 using Gemini based on indices: [1, 2].
2025-08-08 17:55:23,927 - [INFO] - [src.agent:61] - [TIMER] Re-ranking with Gemini took 752.42 ms
2025-08-08 17:55:24,040 - [INFO] - [src.tools.retrievers:32] - [TIMER] Tool: vector_search took 2646.58 ms
2025-08-08 17:55:25,004 - [INFO] - [src.agent:61] - [TIMER] Synthesis LLM Call (Flash) took 1077.41 ms
2025-08-08 17:55:25,005 - [INFO] - [src.agent:61] - [TIMER] Single RAG Step for 'Which sponsors made submission...' took 7069.36 ms
2025-08-08 17:55:25,524 - [INFO] - [src.agent:116] - Re-ranked 3 snippets down to 1 using Gemini based on indices: [0].
2025-08-08 17:55:25,524 - [INFO] - [src.agent:61] - [TIMER] Re-ranking with Gemini took 1481.06 ms
2025-08-08 17:55:26,772 - [INFO] - [src.agent:61] - [TIMER] Synthesis LLM Call (Flash) took 1247.90 ms
2025-08-08 17:55:26,772 - [INFO] - [src.agent:61] - [TIMER] Single RAG Step for 'Which sponsors made submission...' took 8836.12 ms
2025-08-08 17:55:28,702 - [INFO] - [src.agent:61] - [TIMER] Reasoning Synthesis LLM Call (Pro) took 1930.14 ms
2025-08-08 17:55:28,702 - [INFO] - [src.agent:61] - [TIMER] Full Agent Run took 13141.01 ms
2025-08-08 17:55:41,230 - [INFO] - [src.planner.query_rewriter:76] - Query deemed standalone. Bypassing LLM rewrite. Query: 'Compare the submission purposes for Acalabrutinib and Alectinib in the 2025 meetings.'
2025-08-08 17:55:41,670 - [INFO] - [src.planner.persona_classifier:60] - Query classified for persona: 'regulatory_specialist'
2025-08-08 17:55:43,340 - [INFO] - [src.agent:61] - [TIMER] Decomposition took 1669.96 ms
2025-08-08 17:55:43,340 - [INFO] - [src.agent:232] - Executing multi-step plan for query: 'Compare the submission purposes for Acalabrutinib and Alectinib in the 2025 meetings.'
2025-08-08 17:55:43,341 - [INFO] - [src.planner.query_classifier:56] - Classifying query: What was the submission purpose for Acalabrutinib in the 2025 meetings?
2025-08-08 17:55:43,341 - [INFO] - [src.planner.query_classifier:56] - Classifying query: What was the submission purpose for Alectinib in the 2025 meetings?
2025-08-08 17:55:44,088 - [INFO] - [src.planner.query_classifier:76] - Classification result: {
  "intent": "specific_fact_lookup",
  "keywords": [
    "Acalabrutinib",
    "2025 meetings",
    "submission purpose"
  ],
  "question_is_graph_suitable": true,
  "themes": [
    "Regulatory History"
  ]
}
2025-08-08 17:55:44,089 - [INFO] - [src.planner.tool_planner:67] - Planning tools for intent 'specific_fact_lookup' and persona 'regulatory_specialist'
2025-08-08 17:55:44,089 - [INFO] - [src.planner.tool_planner:110] - Coverage threshold of 0.85 met. Finalizing plan.
2025-08-08 17:55:44,089 - [INFO] - [src.planner.tool_planner:113] - Generated tool plan: ['{\n  "tool_name": "query_knowledge_graph",\n  "estimated_coverage": 0.81\n}', '{\n  "tool_name": "vector_search",\n  "estimated_coverage": 0.5\n}']
2025-08-08 17:55:44,089 - [INFO] - [src.agent:132] - Query is suitable for Knowledge Graph. Executing KG tool first.
2025-08-08 17:55:44,089 - [INFO] - [src.router.tool_router:22] - [ToolRouter] Executing tool: 'query_knowledge_graph'
2025-08-08 17:55:44,971 - [INFO] - [src.tools.retrievers:32] - [TIMER] Tool: query_knowledge_graph took 882.42 ms
2025-08-08 17:55:44,972 - [INFO] - [src.agent:142] - KG was unsuitable or did not provide a definitive answer. Executing vector search.
2025-08-08 17:55:44,972 - [INFO] - [src.router.tool_router:22] - [ToolRouter] Executing tool: 'vector_search'
2025-08-08 17:55:44,972 - [INFO] - [src.tools.retrievers:116] - Applying metadata filter: {'semantic_purpose': {'$in': ['Regulatory History']}}
2025-08-08 17:55:45,088 - [INFO] - [src.planner.query_classifier:76] - Classification result: {
  "intent": "specific_fact_lookup",
  "keywords": [
    "Alectinib",
    "submission purpose",
    "2025 meetings"
  ],
  "question_is_graph_suitable": true,
  "themes": [
    "Regulatory History"
  ]
}
2025-08-08 17:55:45,088 - [INFO] - [src.planner.tool_planner:67] - Planning tools for intent 'specific_fact_lookup' and persona 'regulatory_specialist'
2025-08-08 17:55:45,088 - [INFO] - [src.planner.tool_planner:110] - Coverage threshold of 0.85 met. Finalizing plan.
2025-08-08 17:55:45,088 - [INFO] - [src.planner.tool_planner:113] - Generated tool plan: ['{\n  "tool_name": "query_knowledge_graph",\n  "estimated_coverage": 0.81\n}', '{\n  "tool_name": "vector_search",\n  "estimated_coverage": 0.5\n}']
2025-08-08 17:55:45,088 - [INFO] - [src.agent:132] - Query is suitable for Knowledge Graph. Executing KG tool first.
2025-08-08 17:55:45,088 - [INFO] - [src.router.tool_router:22] - [ToolRouter] Executing tool: 'query_knowledge_graph'
2025-08-08 17:55:45,943 - [INFO] - [src.tools.retrievers:32] - [TIMER] Tool: vector_search took 971.47 ms
2025-08-08 17:55:46,342 - [INFO] - [src.tools.retrievers:32] - [TIMER] Tool: query_knowledge_graph took 1253.97 ms
2025-08-08 17:55:46,343 - [INFO] - [src.agent:142] - KG was unsuitable or did not provide a definitive answer. Executing vector search.
2025-08-08 17:55:46,343 - [INFO] - [src.router.tool_router:22] - [ToolRouter] Executing tool: 'vector_search'
2025-08-08 17:55:46,343 - [INFO] - [src.tools.retrievers:116] - Applying metadata filter: {'semantic_purpose': {'$in': ['Regulatory History']}}
2025-08-08 17:55:46,863 - [INFO] - [src.agent:116] - Re-ranked 3 snippets down to 0 using Gemini based on indices: [].
2025-08-08 17:55:46,863 - [INFO] - [src.agent:61] - [TIMER] Re-ranking with Gemini took 919.30 ms
2025-08-08 17:55:46,863 - [INFO] - [src.agent:61] - [TIMER] Single RAG Step for 'What was the submission purpos...' took 3522.21 ms
2025-08-08 17:55:47,458 - [INFO] - [src.tools.retrievers:32] - [TIMER] Tool: vector_search took 1115.72 ms
2025-08-08 17:55:48,024 - [INFO] - [src.agent:116] - Re-ranked 3 snippets down to 0 using Gemini based on indices: [].
2025-08-08 17:55:48,024 - [INFO] - [src.agent:61] - [TIMER] Re-ranking with Gemini took 565.77 ms
2025-08-08 17:55:48,024 - [INFO] - [src.agent:61] - [TIMER] Single RAG Step for 'What was the submission purpos...' took 4683.61 ms
2025-08-08 17:55:49,609 - [INFO] - [src.agent:61] - [TIMER] Reasoning Synthesis LLM Call (Pro) took 1584.17 ms
2025-08-08 17:55:49,609 - [INFO] - [src.agent:61] - [TIMER] Full Agent Run took 8379.24 ms
